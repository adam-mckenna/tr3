---
import { Disqus } from "astro-disqus";

import BaseLayout from "@layouts/BaseLayout.astro";
import { RichTextRenderer } from "@components/RichTextRenderer";
import { getFormattedDate } from "@utils/helpers";

const {
  title,
  body,
  metaDescription,
  publishedDate,
  featuredImage,
  article_author,
  category: categoryFields,
} = Astro.props;

const category = categoryFields.fields.name;
const author = article_author[0].fields;
---

<BaseLayout title={title} metaDescription={metaDescription}>
  <section
    class="w-100vw bg-chardon -mx-4 px-4 pt-6 md:p-0 md:pt-12 lg:pt-12 lg:px-6 lg:py-8 lg:mx-[calc((1216px-100vw)/2)]"
  >
    <div class="max-w-[620px] mx-auto">
      <p
        class="bg-elba py-1 uppercase mb-3 text-xs font-extrabold text-white px-2 w-fit"
      >
        {category}
      </p>

      <h1 class="font-[700] text-3xl text-elba -tracking-[1.25px]">
        {title}
      </h1>

      <p
        class="text-philippine-grey text-lg leading-[25px] -tracking-[.8x] font-serif mt-[6px] mb-4"
      >
        {metaDescription}
      </p>

      <div
        class="flex items-center gap-1 text-elba font-serif w-max mb-8 md:gap-2"
      >
        <span
          class="rounded-full inline-block bg-cover bg-center w-6 h-6 md:w-8 md:h-8 mr-1 border-2 border-elba"
          style={{ backgroundImage: `url('${author.avatar.fields.file.url}')` }}
        ></span>
        <p class="font-semibold">
          <a
            class="transition-all hover:underline focus:underline focus:outline-none focus:ring-2 focus:ring-elba focus:ring-offset-2"
            href={new URL(`authors/${author.slug}`, Astro.site)}
          >
            {author.name}
          </a>
        </p>

        <span class="bg-elba w-1 h-1 rounded-full"></span>
        <p class="text-sm md:text-base">
          {getFormattedDate(publishedDate)}
        </p>
      </div>

      <div
        class="w-full h-[300px] bg-philippine-grey z-20 relative mt-4 bg-cover bg-center"
        style={{
          backgroundImage: `url('${featuredImage.fields.file.url}')`,
        }}
      >
      </div>
      <p class="text-philippine-grey text-xs font-light mt-2">
        {featuredImage.fields.description}
      </p>
    </div>
  </section>

  <section
    class="bg-white min-h-[400px] -mt-[150px] pt-12 px-4 -mx-4 lg:px-6 lg:pt-8 pb-4 md:p-0 w-100vw lg:mx-[calc((1216px-100vw)/2)]"
  >
    <div
      class="grid gap-4 w-full max-w-[620px] mx-auto pt-32 md:pt-[172px] md:pb-8 lg:pt-[112px]"
    >
      <RichTextRenderer body={body} />

      <hr class="border-t opacity-10 mt-4 border-philippine-grey" />

      <Disqus embed="https://tr3.disqus.com/embed.js" />
    </div>
  </section>
</BaseLayout>
